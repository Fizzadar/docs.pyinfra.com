
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
  
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap-theme.min.css" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  <meta name="docsearch:version" content="latest" />
  <meta name="docsearch:language" content="en" />
  
    <title>Getting Started &#8212; pyinfra  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/guzzle.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="shortcut icon" href="_static/logo_small.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using Operations" href="using-operations.html" />
    <link rel="prev" title="pyinfra Documentation" href="index.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="using-operations.html" title="Using Operations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="pyinfra Documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &#187;</li> 
      </ul>
    </div>
  <div class="container-wrapper">
    <header>
      <nav>
        <a target="_blank" href="https://pyinfra.com">pyinfra.com<span class="glyphicon glyphicon glyphicon-share" aria-hidden="true"></span></a>
        <a target="_blank" href="https://github.com/Fizzadar/pyinfra">GitHub<span class="glyphicon glyphicon glyphicon-share" aria-hidden="true"></span></a>
      </nav>

      <div id="header-sidebar">
        <a href="index.html" class="text-logo">
            <img src="_static/logo_small.png" />
            pyinfra <small>latest</small>
        </a>
        
<form id="main-search" class="form-inline" action="search.html" method="GET" role="form">
  <div id="docsearch">
    <input id="search-input" name="q" type="text" class="form-control" placeholder="Search...">
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </div>
</form>
      </div>

      <div id="mobile-toggle">
        <a id="toggle-menu" href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
        <a href="index.html" class="text-logo">
            <img src="_static/logo_small.png" />
        </a>
      </div>
    </header>
    <div id="left-column">
      <div class="sphinxsidebar">
        <div class="sidebar-block">
    <div class="sidebar-toc">
        <p class="caption"><span class="caption-text">Using pyinfra</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ad-hoc-commands-with-pyinfra">Ad-hoc commands with <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#state-definitions">State definitions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-deploy">Create a Deploy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="using-operations.html">Using Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="inventory-data.html">Inventory &amp; Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="arguments.html">Global Arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Using the CLI</a></li>
</ul>
<p class="caption"><span class="caption-text">Deploy Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Deploys</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectors.html">Connectors Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="operations.html">Operations Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="facts.html">Facts Index</a></li>
</ul>
<p class="caption"><span class="caption-text">How pyinfra Works</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/deploys.html">Packaging Deploys</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/connectors.html">Writing Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/operations.html">Writing Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/facts.html">Writing Facts</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy-process.html">Deploy Execution</a></li>
</ul>
<p class="caption"><span class="caption-text">Meta</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Help &amp; Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="compatibility.html">Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/reference.html">API Reference</a></li>
</ul>

    </div>
</div>
      </div>
    </div>
    
      <div id="right-column">
        
          
            <div class="admonition important">
                <p class="first admonition-title">Documentation may contain unreleased features!</p>
                <p>You are reading most recent documentation which may not have been released yet. <a href="/en/2.x/getting-started.html"><strong>2.x</strong></a> is the latest release version available.</p>
            </div>
          
        
        <div class="document clearer body" role="main">
          
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>This guide should help describe the basics of deploying stuff with <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code>.</p>
<p>Install <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> with <a class="reference external" href="https://pipxproject.github.io/pipx/">pipx</a> (recommended) or <code class="docutils literal notranslate"><span class="pre">pip</span></code> (see <a class="reference internal" href="install.html"><span class="doc">full install instructions</span></a>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pipx install pyinfra
</pre></div>
</div>
<p>To do something with pyinfra you need two things:</p>
<dl class="docutils">
<dt><a class="reference internal" href="inventory-data.html"><span class="doc">Inventory</span></a>:</dt><dd><p>Hosts, groups and data. Hosts are targets for <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> to execute commands or state changes (server via SSH, container via Docker, etc). Hosts can be attached to groups, and data can then be assigned to both the groups of hosts and individual hosts.</p>
<p>By default <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> assumes hosts can be reached over SSH. <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> can connect to other systems using <a class="reference internal" href="connectors.html"><span class="doc">connectors</span></a>, for example: a Docker container or the local machine.</p>
</dd>
<dt><a class="reference internal" href="using-operations.html"><span class="doc">Operations</span></a>:</dt><dd><p>Commands to execute or state to apply to the target hosts in the inventory. These can be simple shell commands “execute the <code class="docutils literal notranslate"><span class="pre">uptime</span></code> command” or state definitions such as “ensure the <code class="docutils literal notranslate"><span class="pre">iftop</span></code> apt package is installed”.</p>
<p>Stateful operations will not generate changes unless required by diff-ing the target state against the state defined by operation arguments.</p>
</dd>
</dl>
<div class="section" id="ad-hoc-commands-with-pyinfra">
<h2>Ad-hoc commands with <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code><a class="headerlink" href="#ad-hoc-commands-with-pyinfra" title="Permalink to this headline">¶</a></h2>
<p>You can start <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> immediately with some ad-hoc command execution. The CLI always takes arguments in order <code class="docutils literal notranslate"><span class="pre">INVENTORY</span></code> then <code class="docutils literal notranslate"><span class="pre">OPERATIONS</span></code>. You can target a SSH server, Docker container or the local machine for quick testing:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyinfra INVENTORY OPERATIONS...

<span class="c1"># Execute over SSH</span>
pyinfra my-server.net <span class="nb">exec</span> -- <span class="nb">echo</span> <span class="s2">&quot;hello world&quot;</span>

<span class="c1"># Execute within a new docker container</span>
pyinfra @docker/ubuntu:18.04 <span class="nb">exec</span> -- <span class="nb">echo</span> <span class="s2">&quot;hello world&quot;</span>

<span class="c1"># Execute on the local machine (MacOS/Linux only - for now)</span>
pyinfra @local <span class="nb">exec</span> -- <span class="nb">echo</span> <span class="s2">&quot;hello world&quot;</span>
</pre></div>
</div>
<p>When you run this <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> connects (or spins up a container), runs the echo command and prints the output. The <a class="reference internal" href="cli.html"><span class="doc">CLI page</span></a> contains more <a class="reference internal" href="cli.html#ad-hoc-command-execution"><span class="std std-ref">examples of ad-hoc commands</span></a>.</p>
<div class="section" id="state-definitions">
<h3>State definitions<a class="headerlink" href="#state-definitions" title="Permalink to this headline">¶</a></h3>
<p>Operations can be used to define the desired state of target hosts. Where possible, <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> will then use the state to determine what, if any, changes need to be made to have targets reach that state. This means that when you run these commands for a second time, <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> won’t need to do execute anything because the target is already up to date.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure a package is installed on a Centos 8 instance</span>
pyinfra my-server.net dnf.packages vim

<span class="c1"># Stop a service on a remote host over SSH</span>
pyinfra my-server.net init.systemd httpd <span class="nv">running</span><span class="o">=</span>False <span class="nv">_sudo</span><span class="o">=</span>True
</pre></div>
</div>
<p>In this case you can re-run the above commands and in the second instance <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> will report no changes need to be made.</p>
<div class="note admonition">
<p class="first admonition-title">Note for Docker users</p>
<p class="last">When using <code class="docutils literal notranslate"><span class="pre">&#64;docker/IMAGE</span></code> syntax, <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> will use a new container each run (meaning there will always be changes). You can use the container from the first run in the second (<code class="docutils literal notranslate"><span class="pre">&#64;docker/CTID</span></code>) to test the state change handling.</p>
</div>
</div>
</div>
<div class="section" id="create-a-deploy">
<h2>Create a Deploy<a class="headerlink" href="#create-a-deploy" title="Permalink to this headline">¶</a></h2>
<p>A deploy is a collection of inventories and operations defined in Python files. These deploys can be saved and reused (committed to git, etc). Think of a deploy like Ansible’s playbook or Chef’s cookbook.</p>
<p>To get started create an <code class="docutils literal notranslate"><span class="pre">inventory.py</span></code> containing our hosts to target:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_hosts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;my-server.net&quot;</span><span class="p">,</span> <span class="s2">&quot;@docker/ubuntu:18.04&quot;</span><span class="p">]</span>  <span class="c1"># define a group as a list of hosts</span>
</pre></div>
</div>
<p>Now create a <code class="docutils literal notranslate"><span class="pre">deploy.py</span></code> containing our operations to execute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyinfra.operations</span> <span class="kn">import</span> <span class="n">apt</span><span class="p">,</span> <span class="n">server</span>

<span class="c1"># Define some state - this operation will do nothing on subsequent runs</span>
<span class="n">apt</span><span class="o">.</span><span class="n">packages</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ensure the vim apt package is installed&quot;</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;vim&quot;</span><span class="p">],</span>
    <span class="n">_sudo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># use sudo when installing the packages</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This can now be executed like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyinfra inventory.py deploy.py
</pre></div>
</div>
<p>That’s the basics of <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code>!</p>
<p>Some good next steps:</p>
<ul class="simple">
<li><a class="reference internal" href="using-operations.html"><span class="doc">Using Operations</span></a></li>
<li><a class="reference internal" href="inventory-data.html"><span class="doc">Inventory &amp; Data</span></a></li>
<li><a class="reference internal" href="arguments.html"><span class="doc">Global Arguments</span></a></li>
<li><a class="reference internal" href="cli.html"><span class="doc">Using the CLI</span></a></li>
<li><a class="reference internal" href="examples.html"><span class="doc">Example Deploys</span></a></li>
</ul>
</div>
</div>


        </div>
          
  <nav class="footer-relations">
    <ul class="pager">
      
        <li class="previous"><a href="index.html">
          <span aria-hidden="true">&larr;</span> pyinfra Documentation
        </a></li>
      
        <li class="next"><a href="using-operations.html">
          Using Operations <span aria-hidden="true">&rarr;</span>
        </a></li>
      
    </ul>
  </nav>
    <div class="clearer"></div>
  
      </div>
      <div class="clearfix"></div>
  </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="using-operations.html" title="Using Operations"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="pyinfra Documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("a#toggle-menu").click(function () {
    $("#left-column").slideToggle(100);
  });

  var currentIndexItem = document.querySelector('ul.current ul.current li.current');
  if (currentIndexItem) {
    currentIndexItem.scrollIntoView({'block': 'center'});
  }
</script>
<script type="text/javascript" src="_static/js/bootstrap.js"></script>
  <div class="footer">
  </div>


  <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <script type="text/javascript">
    docsearch({
        apiKey: '25a25b5f5310f306641f9ce07dcb06eb',
        appId: 'XXGX6EX4KA',
        indexName: 'pyinfra',
        container: '#docsearch',
        searchParameters: {
          facetFilters: ["version:latest", "lang:en"],
        },
        debug: false,
    });
  </script>



  
    <script async defer data-domain="docs.pyinfra.com" src="https://stats.oxygem.com/js/index.js"></script>
  

  </body>
</html>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
  
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap-theme.min.css" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="docsearch:version" content="0.x" />
  <meta name="docsearch:language" content="en" />
  
    <title>Getting Started &#8212; pyinfra  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/guzzle.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="shortcut icon" href="_static/logo_small.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Writing Deploys" href="deploys.html" />
    <link rel="prev" title="pyinfra Documentation" href="index.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="deploys.html" title="Writing Deploys"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="pyinfra Documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &#187;</li> 
      </ul>
    </div>
  <div class="container-wrapper">
    <header>
      <nav>
        <a target="_blank" href="https://pyinfra.com">pyinfra.com<span class="glyphicon glyphicon glyphicon-share" aria-hidden="true"></span></a>
        <a target="_blank" href="https://github.com/Fizzadar/pyinfra">GitHub<span class="glyphicon glyphicon glyphicon-share" aria-hidden="true"></span></a>
      </nav>

      <div id="header-sidebar">
        <a href="index.html" class="text-logo">
            <img src="_static/logo_small.png" />
            pyinfra <small>0.x</small>
        </a>
        
<form id="main-search" class="form-inline" action="search.html" method="GET" role="form">
  <input id="docsearch-input" name="q" type="text" class="form-control" placeholder="Search...">
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div id="mobile-toggle">
        <a id="toggle-menu" href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
        <a href="index.html" class="text-logo">
            <img src="_static/logo_small.png" />
        </a>
      </div>
    </header>
    <div id="left-column">
      <div class="sphinxsidebar">
        <div class="sidebar-block">
    <div class="sidebar-toc">
        <p class="caption"><span class="caption-text">Using pyinfra</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ad-hoc-commands-with-pyinfra">Ad-hoc commands with <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#state-definitions">State definitions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-deploy">Create a Deploy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deploys.html">Writing Deploys</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Using the CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectors.html">Connectors</a></li>
</ul>
<p class="caption"><span class="caption-text">Deploy Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="operations.html">Operations Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="facts.html">Facts Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Deploys</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/deploys.html">Packaging Deploys</a></li>
</ul>
<p class="caption"><span class="caption-text">How pyinfra Works</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deploy_process.html">Executing Deploys</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/operations.html">Writing Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/facts.html">Writing Facts</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="compatibility.html">Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Elsewhere</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pyinfra.com">pyinfra.com</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Fizzadar/pyinfra">pyinfra on GitHub</a></li>
</ul>

    </div>
</div>
      </div>
    </div>
    
      <div id="right-column">
        
          
            <div class="admonition important">
                <p class="first admonition-title">Documentation may be out of date!</p>
                <p>You are not reading the most recent version the documentation. <a href="/en/1.x"><strong>1.x</strong></a> is the latest release version available.</p>
            </div>
          
        
        <div class="document clearer body" role="main">
          
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>This guide should help describe the basics of deploying stuff with <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code>.</p>
<p>Install <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> with pip or <a class="reference external" href="https://pipxproject.github.io/pipx/">pipx</a> (see <a class="reference internal" href="install.html"><span class="doc">full install instructions</span></a>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install pyinfra
</pre></div>
</div>
<p>To do something with pyinfra you need two things:</p>
<dl class="docutils">
<dt><strong>Inventory</strong>:</dt><dd>Hosts, groups and data. Hosts are targets for pyinfra to execute commands or state changes. Hosts can belong to one or more groups, and both groups and hosts can have data associated with them. Examples: an SSH server, a Docker container, the local machine.</dd>
<dt><strong>Operations</strong>:</dt><dd>Commands to execute or state to apply to the target hosts in the inventory. These can be simple shell commands (<code class="docutils literal notranslate"><span class="pre">uptime</span></code>) or state definitions such as “ensure the <code class="docutils literal notranslate"><span class="pre">iftop</span></code> apt package is installed”.</dd>
</dl>
<div class="section" id="ad-hoc-commands-with-pyinfra">
<h2>Ad-hoc commands with <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code><a class="headerlink" href="#ad-hoc-commands-with-pyinfra" title="Permalink to this headline">¶</a></h2>
<p>Let’s start off executing a simple ad-hoc shell command. The first argument always specifies the inventory and the following arguments the operations to execute:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyinfra INVENTORY OPERATIONS...

<span class="c1"># Execute an arbitrary shell command</span>
pyinfra my-server.net <span class="nb">exec</span> -- <span class="nb">echo</span> <span class="s2">&quot;hello world&quot;</span>

<span class="c1"># Execute a shell command within a docker container</span>
pyinfra @docker/ubuntu <span class="nb">exec</span> -- bash --version
</pre></div>
</div>
<p>As you’ll see, <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> runs the echo command and prints the output. See the <a class="reference internal" href="cli.html#cli-arguments-options"><span class="std std-ref">available command line options</span></a> and <a class="reference internal" href="cli.html#ad-hoc-command-execution"><span class="std std-ref">examples of ad-hoc commands</span></a>.</p>
<div class="section" id="state-definitions">
<h3>State definitions<a class="headerlink" href="#state-definitions" title="Permalink to this headline">¶</a></h3>
<p>Now that we can execute ad-hoc shell commands, let’s define some state to ensure. The key feature here is that when you run these commands for a second time, <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code> won’t need to do execute anything because the target is already up to date. You can read more about how this works in <a class="reference internal" href="deploy_process.html"><span class="doc">Executing Deploys</span></a>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure a package is installed on a Centos 8 instance</span>
pyinfra @docker/centos8 dnf.packages vim <span class="nv">sudo</span><span class="o">=</span><span class="nb">true</span>

<span class="c1"># Ensure a package is installed on multiple instances</span>
pyinfra @docker/ubuntu18,@docker/debian9 apt.packages vim <span class="nv">sudo</span><span class="o">=</span><span class="nb">true</span>

<span class="c1"># Stop a service on a remote host</span>
pyinfra some_remote_host init.systemd httpd <span class="nv">sudo</span><span class="o">=</span>True <span class="nv">running</span><span class="o">=</span>False
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-a-deploy">
<h2>Create a Deploy<a class="headerlink" href="#create-a-deploy" title="Permalink to this headline">¶</a></h2>
<p>A deploy is a collection of inventories and operations defined in Python files. These deploys can be saved and reused (committed to git, etc). Think of a deploy like Ansible’s playbook or Chef’s cookbook. We’ll now replicate the above hello world ad-hoc command as a deploy.</p>
<p>To get started let’s create an <code class="docutils literal notranslate"><span class="pre">inventory.py</span></code> containing our hosts to target:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define groups of hosts as lists</span>
<span class="n">my_hosts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;my-server.net&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now we need a <code class="docutils literal notranslate"><span class="pre">deploy.py</span></code> containing our operations to execute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyinfra.operations</span> <span class="kn">import</span> <span class="n">apt</span><span class="p">,</span> <span class="n">server</span>

<span class="c1"># Run an ad-hoc command</span>
<span class="n">server</span><span class="o">.</span><span class="n">shell</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;Execute hello world script&#39;</span><span class="p">},</span>  <span class="c1"># Use a set as the first argument to name the operation</span>
    <span class="s1">&#39;echo &quot;hello world&quot;&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Define some state - this operation will do nothing on subsequent runs</span>
<span class="n">apt</span><span class="o">.</span><span class="n">packages</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;Install vim apt package&#39;</span><span class="p">},</span>
    <span class="s1">&#39;vim&#39;</span><span class="p">,</span>
    <span class="n">sudo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># use sudo when installing the packages</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We can now execute this deploy like so:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pyinfra -v inventory.py deploy.py  <span class="c1"># the optional verbose flag &#39;-v&#39; will print the command output</span>
</pre></div>
</div>
<p>That’s the basics of <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code>! Possible next steps:</p>
<ul class="simple">
<li>If you like to dive right into the code check out <a class="reference external" href="https://github.com/Fizzadar/pyinfra/tree/master/examples">the examples on GitHub</a></li>
<li>You can also read the <a class="reference internal" href="deploys.html"><span class="doc">building a deploy guide</span></a> which covers pyinfra’s deploy features</li>
<li>Or <a class="reference internal" href="cli.html"><span class="doc">the CLI user guide</span></a> which covers ad-hoc usage of <code class="docutils literal notranslate"><span class="pre">pyinfra</span></code>.</li>
</ul>
</div>
</div>


        </div>
          
  <nav class="footer-relations">
    <ul class="pager">
      
        <li class="previous"><a href="index.html">
          <span aria-hidden="true">&larr;</span> pyinfra Documentation
        </a></li>
      
        <li class="next"><a href="deploys.html">
          Writing Deploys <span aria-hidden="true">&rarr;</span>
        </a></li>
      
    </ul>
  </nav>
    <div class="clearer"></div>
  
      </div>
      <div class="clearfix"></div>
  </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="deploys.html" title="Writing Deploys"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="pyinfra Documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Home</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("a#toggle-menu").click(function () {
    $("#left-column").slideToggle(100);
  });
</script>
<script type="text/javascript" src="_static/js/bootstrap.js"></script>
  <div class="footer">
  </div>




  
    <script async defer data-domain="docs.pyinfra.com" src="https://stats.oxygem.com/js/index.js"></script>
  

  </body>
</html>